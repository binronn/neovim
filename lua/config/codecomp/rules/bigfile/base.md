# 大文件处理规则

## 核心原则

**禁止完整读取大文件！** 必须使用工具进行定向查找和按需读取。

- 超过 500 行或 100KB 的文件视为大文件
- 不确定大小时，默认按大文件处理

## 禁止的操作

- ❌ 使用 `read_file` 读取整个大文件
- ❌ 请求用户发送完整文件内容
- ❌ 假设已知文件的全部内容
- ❌ 基于不完整信息进行大规模重构

## 标准工作流程

1. **获取文件大纲** — 使用搜索工具查找类定义、函数定义，建立结构概览。
2. **定向定位目标** — 使用 `grep_search` 查找特定函数名、类名、变量或关键字，获取行号。
3. **按需读取片段** — 通过行号范围只读取必要的代码块（如目标函数及其上下文）。
4. **迭代深入** — 如需理解调用关系，逐步搜索调用处和依赖定义，而非一次性加载。

## 代码修改策略

- 使用 `insert_edit_into_file` 时提供足够上下文确保唯一匹配。
- 将大修改拆分为多个小步骤，每步只处理一个逻辑单元。
- 避免重复搜索相同内容，缓存已获取的信息。

## 特殊文件处理

- **JSON/YAML/XML** — 使用路径定位，不要全量读取。
- **日志文件** — 使用范围过滤（行号、时间）。
- **需要全局理解时** — 先生成大纲，基于大纲选择性深入，分步构建理解。

**始终记住：精准定位，按需读取，避免全量加载。**
